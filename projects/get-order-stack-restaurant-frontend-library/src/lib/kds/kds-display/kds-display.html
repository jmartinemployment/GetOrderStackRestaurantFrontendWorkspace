@if (isAuthenticated()) {
<div class="kds-display">
  <header class="kds-header d-flex justify-content-between align-items-center p-3">
    <div class="d-flex align-items-center gap-3">
      <h1 class="h4 mb-0">Kitchen Display</h1>
      @if (restaurantName()) {
        <span class="badge bg-secondary">{{ restaurantName() }}</span>
      }
    </div>
    <div class="d-flex align-items-center gap-3">
      <get-order-stack-connection-status />
      <button type="button" class="btn btn-outline-light btn-sm" (click)="refresh()">
        Refresh
      </button>
    </div>
  </header>

  @if (error()) {
    <div class="p-3">
      <get-order-stack-error-display
        [message]="error()!"
        [retryable]="true"
        (dismissed)="clearError()"
        (retry)="refresh()"
      />
    </div>
  }

  @if (isLoading()) {
    <div class="d-flex justify-content-center p-5">
      <get-order-stack-loading-spinner message="Loading orders..." />
    </div>
  } @else {
    <div class="kds-columns">
      <!-- NEW Orders Column -->
      <div class="kds-column">
        <div class="column-header new">
          <h2 class="h5 mb-0">NEW</h2>
          <span class="badge bg-light text-dark">{{ pendingOrders().length }}</span>
        </div>
        <div class="column-body">
          @for (order of pendingOrders(); track order.id) {
            <get-order-stack-order-card
              [order]="order"
              (statusChange)="onStatusChange($event)"
            />
          } @empty {
            <div class="empty-state text-center p-4">
              <p class="text-muted mb-0">No new orders</p>
            </div>
          }
        </div>
      </div>

      <!-- COOKING Orders Column -->
      <div class="kds-column">
        <div class="column-header cooking">
          <h2 class="h5 mb-0">COOKING</h2>
          <span class="badge bg-light text-dark">{{ preparingOrders().length }}</span>
        </div>
        <div class="column-body">
          @for (order of preparingOrders(); track order.id) {
            <get-order-stack-order-card
              [order]="order"
              (statusChange)="onStatusChange($event)"
            />
          } @empty {
            <div class="empty-state text-center p-4">
              <p class="text-muted mb-0">No orders cooking</p>
            </div>
          }
        </div>
      </div>

      <!-- READY Orders Column -->
      <div class="kds-column">
        <div class="column-header ready">
          <h2 class="h5 mb-0">READY</h2>
          <span class="badge bg-light text-dark">{{ readyOrders().length }}</span>
        </div>
        <div class="column-body">
          @for (order of readyOrders(); track order.id) {
            <get-order-stack-order-card
              [order]="order"
              (statusChange)="onStatusChange($event)"
            />
          } @empty {
            <div class="empty-state text-center p-4">
              <p class="text-muted mb-0">No orders ready</p>
            </div>
          }
        </div>
      </div>
    </div>
  }
</div>
} @else {
  <div class="auth-required d-flex align-items-center justify-content-center p-5">
    <div class="text-center">
      <h3 class="text-warning mb-3">Authentication Required</h3>
      <p class="text-light">Please log in to view the kitchen display.</p>
    </div>
  </div>
}
